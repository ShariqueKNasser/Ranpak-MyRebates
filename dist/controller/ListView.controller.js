sap.ui.define(["ranpak/wz/rebatelist/controller/BaseController","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/Token","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/Fragment","sap/m/BusyDialog","sap/ui/table/Column","sap/m/Text","sap/m/DatePicker","sap/m/Input","sap/ui/core/format/NumberFormat"],function(e,t,a,r,l,i,s,o,n,d,u,g,c){"use strict";return e.extend("ranpak.wz.rebatelist.controller.ListView",{onInit:function(){var e=this.getOwnerComponent();this._router=e.getRouter();this._router.getRoute("ListView").attachPatternMatched(this._handleRouteMatched,this)},_handleRouteMatched:function(e){this.oBusyDialog=new o;this.oI18n=this.getView().getModel("i18n").getResourceBundle();this.oUserEditMdl=this.getOwnerComponent().getModel("oUserEditMdl");this.oBlkUpldMdl=this.getOwnerComponent().getModel("oBlkUpldMdl");this.oFiltrKeys=["RebateID","ValidTo","CustomerID","EndUserID","MaterialID","Status"];this.oClmSbmsnDt=[];this.resetAttachMdl();const t=function(e){const t=e.text;return new r({key:t,text:t})};this.byId("inputRebateID").addValidator(t);var a=new Date;var l=new Date((new Date).setDate(a.getDate()-60));this.oUserEditMdl.setProperty("/maxDate",new Date);this.oUserEditMdl.setProperty("/minDate",l)},onFilterClear:function(e){var t=this.getView().byId("idMyRebatesFB");var a="";for(var r=0;r<this.oFiltrKeys.length;r++){a=t.getControlByKey(this.oFiltrKeys[r]);if(this.oFiltrKeys[r]==="RebateID"){a.setTokens([])}else if(this.oFiltrKeys[r]==="ValidTo"){a.setValue(null)}else if(this.oFiltrKeys[r]==="Status"){a.setSelectedKey(null)}else{a.setSelectedKeys([])}}var l=this.getView().byId("idMyRebatesPg");var i=this.getView().byId("idMyRebatesTbl");var s=i.getTable().getSelectedItems();this.onTblMutliDSlct(l,s);t.fireSearch();this.resetAttachMdl()},onBeforeRebindTbl:function(e){var l=this.getView().byId("idMyRebatesFB");var i=e.getParameter("bindingParams");var s=i.parameters.select;s+=",MaterialDescription,EndUserDescription,CustomerDescription,Currency";i.parameters.select=s;var o=l.getAllFiltersWithValues();for(var n=0;n<o.length;n++){this.formFiltersForTable(i,l,o[n])}const d=new sap.ui.core.routing.HashChanger;let u=d.getHash();if(u){u=u.split("SearchString=")[1];if(!u){return}const e=new t("RebateID",a.Contains,u);const l=new t("CustomerDescription",a.Contains,u);const s=new t("CustomerID",a.Contains,u);const o=new t([e,l,s],false);i.filters.push(o);this.byId("inputRebateID").setTokens([new r({key:u,text:u})])}},formFiltersForTable:function(e,t,a){var r=a.getName();var l=t.getControlByKey(r);var i="",s="";switch(r){case"RebateID":i=l.getTokens();s=this.formMultiFiltrMdl(i,"RebateID",true);break;case"CustomerID":i=l.getSelectedKeys();s=this.formMultiFiltrMdl(i,"CustomerID",true);break;case"ValidTo":i=l.getDateValue();s=this.formMultiFiltrMdl(i,"ValidTo",false,l);break;case"EndUserID":i=l.getSelectedKeys();s=this.formMultiFiltrMdl(i,"EndUserID",true);break;case"MaterialID":i=l.getSelectedKeys();s=this.formMultiFiltrMdl(i,"MaterialID",true);break;case"Status":i=l.getSelectedKey();s=this.formMultiFiltrMdl(i,"Status",false);break;default:break}e.filters.push(s)},formMultiFiltrMdl:function(e,a,r,l){var i=[],s="",o="",n="",d="EQ";if(r){for(var u=0;u<e.length;u++){if(a==="RebateID"){d="EQ";o=e[u].getText()}else{o=e[u].toUpperCase()}}}else{if(a==="ValidTo"){d="BT";o=this.fetchDate(l.getDateValue());n=new Date(l.getSecondDateValue().getFullYear(),l.getSecondDateValue().getMonth()+1,0);n=this.fetchDate(n)}else if(a==="Status"){o=e}}s=new t({path:a,operator:d,value1:o,value2:n});i.push(s);return new t(i)},onBeforeVariantFetch:function(e){var t=this.getView().byId("idMyRebatesFB");var a=[];var r=t.getControlByKey("RebateID").getTokens();for(var l=0;l<r.length;l++){a.push(r[l].getText())}t.setFilterData({_CUSTOM:{RebateID:a,ValidTo:t.getControlByKey("ValidTo").getValue(),CustomerID:t.getControlByKey("CustomerID").getSelectedKeys(),EndUserID:t.getControlByKey("EndUserID").getSelectedKeys(),MaterialID:t.getControlByKey("MaterialID").getSelectedKeys(),Status:t.getControlByKey("Status").getSelectedKey()}})},onVariantLoad:function(e){var t=this.getView().byId("idMyRebatesFB");var a=t.getFilterData();var l=a["_CUSTOM"];var i=[];for(var s=0;s<l.RebateID.length;s++){i.push(new r({key:l.RebateID[s],text:l.RebateID[s]}));t.getControlByKey("RebateID").setTokens(i)}t.getControlByKey("CustomerID").setSelectedKeys(l.CustomerID);t.getControlByKey("EndUserID").setSelectedKeys(l.EndUserID);t.getControlByKey("MaterialID").setSelectedKeys(l.MaterialID);t.getControlByKey("ValidTo").setValue(l.ValidTo);t.getControlByKey("Status").setSelectedKey(l.Status)},onMyRebatesExport:function(e){var t="";t="My_Rebates_"+(new Date).toISOString();e.getParameter("exportSettings").fileName=t;this.formatExportList(e)},formatExportList:function(e){var t=e.getParameter("exportSettings").workbook;var a=t.columns;t.context={sheetName:"My Rebates"};for(var r=0;r<a.length;r++){switch(a[r].label){case this.oI18n.getText("columnCustomer"):a[r].property=["CustomerDescription","CustomerID"];a[r].template="{0} ({1})";break;case this.oI18n.getText("columnRebateID"):a[r].property="RebateID";break;case this.oI18n.getText("columnEndUser"):a[r].property=["EndUserDescription","EndUserID"];a[r].template="{0} ({1})";break;case this.oI18n.getText("columnMaterial"):a[r].property=["MaterialDescription","MaterialID"];a[r].template="{0} ({1})";break;case this.oI18n.getText("columnUnit"):a[r].property="Unit";break;case this.oI18n.getText("columnListPrice"):a[r].property="ListPrice";break;case this.oI18n.getText("columnRebateAmount"):a[r].property="RebateAmount";break;case this.oI18n.getText("columnNetPrice"):a[r].property="NetPrice";break;case this.oI18n.getText("columnValidFrom"):a[r].type=sap.ui.export.EdmType.Date;a[r].property="ValidFrom";a[r].format="YYYY/MM/dd";break;case this.oI18n.getText("columnValidTo"):a[r].type=sap.ui.export.EdmType.Date;a[r].property="ValidTo";a[r].format="YYYY/MM/dd";break;case this.oI18n.getText("columnStatus"):a[r].property="Status";break;case this.oI18n.getText("columnEndUserPrice"):a[r].property="EndUserPrice";break;default:break}}},GetStatusState:function(e){if(e===this.oI18n.getText("filterStatusActive")){return"Success"}if(e===this.oI18n.getText("filterStatusExpired")){return"Error"}},onTblMutliDSlct:function(e,t,a){var r,l;for(var i=0;i<t.length;i++){t[i].setSelected(false);r=t[i].getCells();for(var s=0;s<r.length;s++){l=r[s].getCustomData();if(l.length>0){if(l[0].getKey()==="INVOICE_NO"||l[0].getKey()==="SHIP_DATE"||l[0].getKey()==="QUANTITY_SOLD"){r[s].setVisible(false);r[s].setValue(null)}}}}e.setShowFooter(false);this.oClmSbmsnDt=[];this.oUserEditMdl.setProperty("/claimSubmissionData",this.oClmSbmsnDt);this.oUserEditMdl.refresh(true)},onTblItmSnglSlctn:function(e,t,a,r,i,s,o){var n;if(a==="Expired"){l.show(this.oI18n.getText("INVALID_ITEM_SELECT"));e.setSelected(false)}else{for(var d=0;d<t.length;d++){n=t[d].getCustomData();if(n.length>0){if(n[0].getKey()==="INVOICE_NO"||n[0].getKey()==="SHIP_DATE"||n[0].getKey()==="QUANTITY_SOLD"){if(r){t[d].setVisible(true)}else{t[d].setVisible(false)}}}}if(i.length===0){s.setShowFooter(false)}else{if(!s.getShowFooter()){s.setShowFooter(true)}this.formClmSubmsnDt(o,r)}}},onTblItmSlct:function(e){var t=this.getView().byId("idMyRebatesPg");var a=e.getParameter("listItems");if(a.length>1){this.onTblMutliDSlct(t,a)}else{var r=this.getView().byId("idMyRebatesTbl");var l=r.getTable().getSelectedItems();var i=e.getParameter("listItem");var s=i.getBindingContext().getObject();var o=s.Status;var n=i.getCells();var d=e.getParameter("selected");this.onTblItmSnglSlctn(i,n,o,d,l,t,s)}},formClmSubmsnDt:function(e,t){e.End_User_Invoice="";e.End_User_Ship_Date="";e.Quantity="";if(t){this.oClmSbmsnDt.push(e)}else{for(var a=0;a<this.oClmSbmsnDt.length;a++){if(e.ID===this.oClmSbmsnDt[a].ID){this.oClmSbmsnDt.splice(a)}}}this.oUserEditMdl.setProperty("/claimSubmissionData",this.oClmSbmsnDt);this.oUserEditMdl.refresh(true)},onClmFldEdit:function(e){var t=e.getSource().getCustomData()[0].getKey();var a=e.getSource().getBindingContext().getObject();for(var r=0;r<this.oClmSbmsnDt.length;r++){if(a.ID===this.oClmSbmsnDt[r].ID){if(t==="INVOICE_NO"){var i=this.validateAlphaNumFld(e);if(i){e.getSource().setValueState("None");this.oClmSbmsnDt[r].End_User_Invoice=e.getSource().getValue()}else{l.show(this.oI18n.getText("INVALID_ENTRY"));e.getSource().setValueState("Error");e.getSource().setValue(null)}}else if(t==="SHIP_DATE"){this.oClmSbmsnDt[r].End_User_Ship_Date=e.getSource().getValue()}else if(t==="QUANTITY_SOLD"){var s=this.validateNumberFld(e);if(s){e.getSource().setValueState("None");this.oClmSbmsnDt[r].Quantity=e.getSource().getValue()}else{l.show(this.oI18n.getText("INVALID_ENTRY"));e.getSource().setValueState("Error");e.getSource().setValue(null)}}}}this.oUserEditMdl.setProperty("/claimSubmissionData",this.oClmSbmsnDt);this.oUserEditMdl.refresh(true)},validatePayload:function(){var e=1;var t=this.getView().byId("idMyRebatesTbl");var a=t.getTable().getSelectedItems();var r,l,i;for(var o=0;o<a.length;o++){r=a[o].getCells();for(var n=0;n<r.length;n++){l=r[n].getCustomData();if(l.length>0){i=l[0].getKey();if(i==="INVOICE_NO"||i==="SHIP_DATE"||i==="QUANTITY_SOLD"){if(!r[n].getValue()){r[n].setValueState("Error");e=0}else{r[n].setValueState("None")}}}}}if(e===1){this.oBusyDialog.open();e=2;var d=this.getView();var u=this;var g=this.getView().byId("idSubmitWithDocBtn");if(!this.byId("idAttachmentDlg")){s.load({id:d.getId(),name:"ranpak.wz.rebatelist.fragment.attachmentDlg",controller:this}).then(function(e){d.addDependent(e);e.open();d.byId("idMyRebatesPg").setShowFooter(false);u.resetAttachMdl();if(g){g.setEnabled(false)}u.oBusyDialog.close()})}else{this.byId("idAttachmentDlg").open();this.byId("idMyRebatesPg").setShowFooter(false);this.resetAttachMdl();if(g){g.setEnabled(false)}this.oBusyDialog.close()}}return e},onAttachmentUpload:function(e){var t=e.getSource().oFileUpload.files;var a=this.getOwnerComponent().getModel("oAttachmentMdl");var r=a.getProperty("/results");this.formAttachments(t,a,r)},formAttachments:function(e,t,a){var r="",i="",s="",o="",n=0;for(var d=0;d<e.length;d++){r=e[d].name;s=e[d].size;i=e[d].size/(1024*1024);i=parseFloat(i.toFixed(2));o=r.substring(r.lastIndexOf(".")+1,r.length)||r;o=o.toUpperCase();if(o==="XLSX"||o==="XLS"||o==="CSV"||o==="PNG"||o==="JPEG"||o==="JPG"||o==="PDF"||o==="DOCX"||o==="DOC"||o==="TXT"||o==="PPTX"||o==="PPT"||o==="MSG"||o==="EML"){for(var u=0;u<a.length;u++){if(r===a[u].fileName){l.show(this.oI18n.getText("SAME_FILE_NAME"));return}else{n+=parseFloat(a[u].fileSize.split(" MB")[0])}}n+=i;if(n>50){l.show(this.oI18n.getText("DOC_SIZE_ERROR"))}else{this.updateAttachmentsModel(e[d],t,a,r,s,i,o)}}else{l.show(this.oI18n.getText("SUPPORTED_DOC"))}}},updateAttachmentsModel:function(e,t,a,r,l,i,s){var o=this.getView().byId("idSubmitWithDocBtn");var n=this.getView().byId("idBlkSubmitBtn");var d=new FileReader;d.readAsDataURL(e);d.onloadend=function(e){if(e.target.readyState===FileReader.DONE){var d=e.target.result;var u=d.split(",")[1];a.push({b64Content:u,fileName:r,fileSizeBytes:l,fileSize:i+" MB",fileType:s});t.refresh(true);if(o){o.setEnabled(true)}if(n){n.setEnabled(true)}}}},onSubmitClm:function(){var e=this.validatePayload();if(e===0){i.error(this.oI18n.getText("VALIDATE_PAYLOAD_ERR"))}},onAttachmentDel:function(e){var t=this.getOwnerComponent().getModel("oAttachmentMdl");var a=t.getProperty("/results");var r=e.getSource().getBindingContext("oAttachmentMdl");var l=r.getPath().split("/")[2];a.splice(l,1);t.refresh(true);if(a.length===0){if(this.byId("idSubmitWithDocBtn")){this.byId("idSubmitWithDocBtn").setEnabled(false)}if(this.byId("idBlkSubmitBtn")){this.byId("idBlkSubmitBtn").setEnabled(false)}}},onSubmitClmWithDoc:function(){this.triggerRebateClmSubmit()},formClmPayload:function(){var e=[];var t="",a;for(var r=0;r<this.oClmSbmsnDt.length;r++){t="";a=10-this.oClmSbmsnDt[r].RebateID.length;for(var l=0;l<a;l++){t+="0"}t+=this.oClmSbmsnDt[r].RebateID;e.push({Rebate_ID:t,Sales_Organization:"",Distributor_No:this.oClmSbmsnDt[r].CustomerID,Distributor_Name:this.oClmSbmsnDt[r].CustomerDescription,End_User_No:this.oClmSbmsnDt[r].EndUserID,End_user_Name:this.oClmSbmsnDt[r].EndUserDescription,End_User_City:"",End_user_State:"",Your_Sales_Office:"",Your_Sales_Office_Name:"",Your_Item:"",Your_Item_Description:"",Ranpak_Item:this.oClmSbmsnDt[r].MaterialID,End_User_Invoice:this.oClmSbmsnDt[r].End_User_Invoice,End_User_Ship_Date:this.oClmSbmsnDt[r].End_User_Ship_Date,col16:"",col17:"",Resale_Price:"",List_Price:this.oClmSbmsnDt[r].ListPrice,Rebate_Amount:this.oClmSbmsnDt[r].RebateAmount,Net_Price:this.oClmSbmsnDt[r].NetPrice,Quantity:this.oClmSbmsnDt[r].Quantity,UOM:this.oClmSbmsnDt[r].Unit,Customer_Reference:""})}var i={file_name:"REBATE_CLAIM",dummytoexcelset:e,dummytomessageset:[]};return i},triggerRebateClmSubmit:function(e){this.oBusyDialog.open();var t=this;var a="";if(e){a=this.formBlkClmPayload()}else{a=this.formClmPayload()}var r=this.getOwnerComponent().getModel("oPOSTMdl");r.create("/dummyheaderSet",a,{success:function(r){var l=r.dummytomessageset.results;var s="",o="",n="",d="",u=0;for(var g=0;g<l.length;g++){o=l[g].Message_Type;s=l[g].Messages;if(l.length===t.oClmSbmsnDt.length){d=t.oClmSbmsnDt[g].RebateID;if(o==="E"||o==="W"){if(s){s=s.split(":")[1]}n+="\nRebate ID "+d+" : "+s}else if(o==="S"){u=1;n+="\n"+s;t.upldDocToSharePoint(n,e,a)}}else{if(o==="E"||o==="W"){n+="\n"+s}else if(o==="S"){u=1;n+="\n"+s;t.upldDocToSharePoint(n,e,a)}}}if(u===0){i.error(n);t.oBusyDialog.close()}},error:function(e){t.oBusyDialog.close();var a=JSON.parse(e.responseText);i.error(a.error.message.value)}})},onClmWithDocCncl:function(){this.resetAttachMdl();this.byId("idAttachmentDlg").close();this.byId("idMyRebatesPg").setShowFooter(true)},upldDocToSharePoint:function(e,t,a){this.oBusyDialog.open();var r=this;var l=this.getOwnerComponent().getModel("oAttachmentMdl");var s=l.getProperty("/results");var o=[];for(var n=0;n<s.length;n++){o.push({name:s[n].fileName,content:s[n].b64Content})}var d={};var u="";u=e.match(/(\d+)/)[0];if(t){d={customerId:a.dummytoexcelset[0].Distributor_No,customerName:a.dummytoexcelset[0].Distributor_Name,rebateClaimNo:u,docs:o}}else{d={customerId:this.oClmSbmsnDt[0].CustomerID,customerName:this.oClmSbmsnDt[0].CustomerDescription,rebateClaimNo:u,docs:o}}var g=this.getOwnerComponent().getModel();g.create("/UploadDocuments",d,{success:function(t){if(r.byId("idAttachmentDlg")){r.byId("idAttachmentDlg").close()}if(r.byId("idBlkRbtClmDlg")){r.byId("idBlkRbtClmDlg").close()}r.oBusyDialog.close();i.success(e+"\n\n"+"Supporting documents uploaded successfully",{onClose:function(){r.onFilterClear()}})},error:function(t){if(r.byId("idAttachmentDlg")){r.byId("idAttachmentDlg").close()}r.oBusyDialog.close();var a=JSON.parse(t.responseText);var l=a.error.message.value+". "+r.oI18n.getText("TRY_AGAIN");i.error(e+"\n"+l)}})},onBulkBtnPress:function(){this.oBusyDialog.open();var e=this.getView();var t=this;if(!this.byId("idBlkRbtClmDlg")){s.load({id:e.getId(),name:"ranpak.wz.rebatelist.fragment.bulkRebateClaimWizard",controller:this}).then(function(a){e.addDependent(a);a.open();t.oBlkRbtClmWiz=e.byId("idBlkRbtClmWiz");t.idDwnldTmpltWizStp=e.byId("idDwnldTmpltWizStp");t.oUpldTmpltWizStp=e.byId("idUpldTmpltWizStp");t.oReviewWizStp=e.byId("idReviewWizStp");t.oAttachUpldWizStp=e.byId("idAttachUpldWizStp");var r=e.byId("idMyRebatesPg");var l=e.byId("idMyRebatesTbl");var i=l.getTable().getSelectedItems();t.onTblMutliDSlct(r,i);t.resetBlkClmWiz();t.oBusyDialog.close()})}else{this.byId("idBlkRbtClmDlg").open();var a=e.byId("idMyRebatesPg");var r=e.byId("idMyRebatesTbl");var l=r.getTable().getSelectedItems();this.onTblMutliDSlct(a,l);this.resetBlkClmWiz();this.oBusyDialog.close()}},resetBlkClmWiz:function(){this.oBlkRbtClmWiz.setCurrentStep(this.idDwnldTmpltWizStp);var e=this.getView().byId("idBlkSubmitBtn");e.setEnabled(false);this.resetAttachMdl()},onBlkCncl:function(){this.resetBlkClmWiz();this.byId("idBlkRbtClmDlg").close()},onDwnldTemplt:function(){var e=this.getAppModulePath()+"/artifacts/Rebate-Claim-Template.xlsx";sap.m.URLHelper.redirect(e,true);this.oBlkRbtClmWiz.setCurrentStep(this.oUpldTmpltWizStp)},onUpldTemplt:function(e){this.oBusyDialog.open();var t=e.getSource().oFileUpload.files[0];this.resetAttachMdl();var a=this.getView().byId("idBlkSubmitBtn");a.setEnabled(false);this.oParseExcel(t)},oParseExcel:function(e){var t=this;var a={},r="",l=e.name,s=l.substring(l.lastIndexOf(".")+1,l.length)||l;s=s.toUpperCase();if(s==="XLSX"){if(e&&window.FileReader){var o=new FileReader;o.onload=function(l){var s=l.target.result;var o=XLSX.read(s,{type:"binary"});o.SheetNames.forEach(function(e){r=o.Sheets[e];a=XLSX.utils.sheet_to_row_object_array(r)});if(a.length>0){t.setExcelDtToTbl(r,a);t.generateTable();t.oBlkRbtClmWiz.setCurrentStep(t.oReviewWizStp);t.oBlkRbtClmWiz.setCurrentStep(t.oAttachUpldWizStp);t.upldTmpltToAttachMdl(e)}else{i.error(t.oI18n.getText("UPLOAD_FILE_EMPTY"));t.oBlkRbtClmWiz.setCurrentStep(t.oUpldTmpltWizStp);t.oBusyDialog.close()}};o.readAsBinaryString(e)}}else{i.error(this.oI18n.getText("UNSUPPORTED_FILE_TYPE"));this.oBusyDialog.close()}},upldTmpltToAttachMdl:function(e){var t=this;var a,r,l,i;a=e.name;r=e.size;l=e.size/(1024*1024);l=parseFloat(l.toFixed(2));i=a.substring(a.lastIndexOf(".")+1,a.length)||a;i=i.toUpperCase();var s=this.getOwnerComponent().getModel("oAttachmentMdl");var o=s.getProperty("/results");var n=new FileReader;n.readAsDataURL(e);n.onloadend=function(e){if(e.target.readyState===FileReader.DONE){var n=e.target.result;var d=n.split(",")[1];o.push({b64Content:d,fileName:a,fileSizeBytes:r,fileSize:l+" MB",fileType:i});s.refresh(true);t.oBusyDialog.close()}}},setExcelDtToTbl:function(e,t){const a=[];const r=XLSX.utils.decode_range(e["!ref"]).e.c+1;for(let t=0;t<r;++t){if(e[XLSX.utils.encode_col(t)+1]){a[t]=e[XLSX.utils.encode_col(t)+1].v}}this.oBlkUpldMdl.setProperty("/columns",a);this.oBlkUpldMdl.setProperty("/rows",t)},generateTblTmplt:function(e){var t=this;var a="";var r=new Date;var l=new Date((new Date).setDate(r.getDate()-60));if(e){if(e.toUpperCase().indexOf("DATE")!==-1){a=new u({value:{path:"oBlkUpldMdl>"+e,formatter:this.validateDateFldBlk},displayFormat:"YYYY/MM/dd",valueFormat:"YYYY-MM-dd",change:function(e){this.setValueState("None");if(e.getSource().getBindingContext("oBlkUpldMdl")){e.getSource().getBindingContext("oBlkUpldMdl").getObject()[e.getSource().getBindingInfo("value").parts[0].path]=e.getSource().getValue()}},maxDate:r,minDate:l});return a}else if(e.toUpperCase().indexOf("#")!==-1||e.toUpperCase().indexOf("NUMBER")!==-1){a=new g({value:{path:"oBlkUpldMdl>"+e,formatter:this.validateAlphaNumFldBlk},change:function(e){var a=t.validateAlphaNumFld(e);if(a){e.getSource().setValueState("None")}else{e.getSource().setValueState("Error");e.getSource().setValue(null)}if(e.getSource().getBindingContext("oBlkUpldMdl")){e.getSource().getBindingContext("oBlkUpldMdl").getObject()[e.getSource().getBindingInfo("value").parts[0].path]=e.getSource().getValue()}}});return a}else if(e.toUpperCase().indexOf("AMOUNT")!==-1||e.toUpperCase().indexOf("PRICE")!==-1){a=new g({value:{path:"oBlkUpldMdl>"+e,formatter:this.validateAmntFldBlk},change:function(e){var a=e.getSource().getValue();var r=c.getCurrencyInstance({currencyCode:false,decimals:2});var l=t.validateNumberFld(e);if(l){e.getSource().setValueState("None");e.getSource().setValue(r.format(a))}else{e.getSource().setValueState("Error");e.getSource().setValue(null)}if(e.getSource().getBindingContext("oBlkUpldMdl")){e.getSource().getBindingContext("oBlkUpldMdl").getObject()[e.getSource().getBindingInfo("value").parts[0].path]=e.getSource().getValue()}}});return a}else if(e.toUpperCase().indexOf("NAME")!==-1){a=new g({value:{path:"oBlkUpldMdl>"+e},change:function(e){var t=e.getSource().getValue();if(e.getSource().getBindingContext("oBlkUpldMdl")){e.getSource().getBindingContext("oBlkUpldMdl").getObject()[e.getSource().getBindingInfo("value").parts[0].path]=t}}});return a}else{a=new g({value:{path:"oBlkUpldMdl>"+e,formatter:this.validateAlphaNumFldBlk},change:function(e){var a=t.validateAlphaNumFld(e);if(a){e.getSource().setValueState("None")}else{e.getSource().setValueState("Error");e.getSource().setValue(null)}if(e.getSource().getBindingContext("oBlkUpldMdl")){e.getSource().getBindingContext("oBlkUpldMdl").getObject()[e.getSource().getBindingInfo("value").parts[0].path]=e.getSource().getValue()}}});return a}}else{a=new g({value:{path:"oBlkUpldMdl>"+e,formatter:this.validateAlphaNumFldBlk},change:function(e){var a=t.validateAlphaNumFld(e);if(a){e.getSource().setValueState("None")}else{e.getSource().setValueState("Error");e.getSource().setValue(null)}if(e.getSource().getBindingContext("oBlkUpldMdl")){e.getSource().getBindingContext("oBlkUpldMdl").getObject()[e.getSource().getBindingInfo("value").parts[0].path]=e.getSource().getValue()}}});return a}},generateTable:function(){var e=this;var t=this.getView().byId("idBlkUpldTbl");t.bindColumns("oBlkUpldMdl>/columns",function(t,a){var r=a.getObject();if(r&&r.indexOf("/")!==-1){r=r.split("/")[0]}var l=e.generateTblTmplt(r);return new n({label:r,template:l,width:"12rem",tooltip:r,sortProperty:r,filterProperty:r})});t.bindRows("oBlkUpldMdl>/rows")}})});
//# sourceMappingURL=ListView.controller.js.map